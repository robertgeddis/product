select distinct
  upper(countrycode) as country,
  case when entityType = 'JobApplicationTemplate' then 'Job Application'
       when entityType = 'ReviewResponse' then 'Review Response'
       when entityType = 'VerticalProfile' then 'Profile'
    else entityType end as Content_Type, 
  case when rejectReason is null then 'No Reason' else 
    trim(regexp_replace(regexp_replace(split_part(rejectReason, ',', 1),'(Rejected|SecurityBreach|TOU)',''),'([a-z])([A-Z])', '\1 \2')) end as Violation,
  count(distinct objectId) as No_Items
from intl.hive_event 
where name = 'CSRApproval'
  and date(datecreated) between '2024-07-01' and '2025-01-31'
  and approvalAction = 'Rejected'
group by 1,2,3
